import { Token } from "../../global.slint";
import { Page, Button, ButtonType } from "../../components/index.slint";
import { SCard,STimeLine,STimeLineItem } from "../../modules/surrealism-ui/index.slint";
import {SStar,SButton} from "../../modules/surrealism-ui/index.slint";
import { Card } from "../../components/card.slint";
import { SPagination } from "../../modules/surrealism-ui/index.slint";
import {Themes,UseIcons} from "../../modules/surrealism-ui/use/index.slint";
import { ScrollView, LineEdit } from "std-widgets.slint";

export struct HistroyEventStruct {
    id: int,
    date-time: string,
    title: string,
    description: string,
}

export global HistoryPageBridge {
    in property <[HistroyEventStruct]> events:[
        {
            id:1,
            date-time:"2024.7.24",
            title: "软件研发部C++组授课", 
            description:"软件研发部C++组授课",
        },
        {
            id:1,
            date-time:"2024.7.24",
            title: "软件研发部C++组授课", 
            description:"软件研发部C++组授课",
        },
        {
            id:1,
            date-time:"2024.7.24",
            title: "软件研发部C++组授课", 
            description:"软件研发部C++组授课",
        },
        {
            id:1,
            date-time:"2024.7.24",
            title: "软件研发部C++组授课", 
            description:"软件研发部C++组授课",
        },
        {
            id:1,
            date-time:"2024.7.24",
            title: "软件研发部C++组授课", 
            description:"软件研发部C++组授课",
        },
    ];
}

component CommentItem {
    property <string> context;
    property <bool> reviewed;
    property <bool> editing;
    callback comment-clicked();
    VerticalLayout {
        spacing: 8px;
        SStar {
            score: 3;
            theme: Dark;
        }

        HorizontalLayout {
            spacing: 8px;
            LineEdit {
                width: 80%;
                height: 40px;
            }

            Button {
                content: "评价";
                type: ButtonType.filled-tonal;
                clicked => {
                    comment-clicked();
                }
            }
        }
    }
}

component DividerVirtical inherits Rectangle {
    width: 8px;
    Rectangle {
        x: 2px;
        width: 4px;
        height: 90%;
        border-radius: 2px;
        background: Token.color.primary-container;
        Rectangle {
            y: parent.height / 2 - 4px;
            width: 8px;
            height: 8px;
            border-radius: 4px;
            background: Token.color.on-primary-container;
        }
    }
}

component HistoryCard {
    height: 100px;
    in property <string> date-time;
    in property <string> title;
    in property <string> description;
    in property <int> id;
    callback event-clicked(int);
    callback comment-clicked(int);
    HorizontalLayout {
        spacing: 5px;
        height: 100px;
        Rectangle {
            height: 100px;
            Text {
                text: date-time;
                font-size: Token.font.body.large.size;
                font-weight: Token.font.body.large.weight;
                color: Token.color.outline;
                horizontal-alignment: center;
                vertical-alignment: center;
            }
        }

        DividerVirtical {
            height: 100px;
        }

        Card {
            height: 100px;
            width: 90%;
            clicked => {
                root.event-clicked(id);
            }
            HorizontalLayout {
                padding: 5px;
                padding-right: 15px;
                spacing: 8px;
                VerticalLayout {
                    Text {
                        horizontal-alignment: TextHorizontalAlignment.left;
                        vertical-alignment: TextVerticalAlignment.top;
                        text: title;
                        overflow: elide;
                        font-size: Token.font.headline.small.size;
                        font-weight: Token.font.headline.small.weight;
                        color: Token.color.on-surface;
                    }

                    Text {
                        font-size: Token.font.label.large.size;
                        text: description;
                        overflow: elide;
                        color: Token.color.on-surface;
                    }
                }

                CommentItem {
                    width: 40%;
                    comment-clicked => {
                        root.comment-clicked(id);
                    }
                }
            }
        }
    }
}

export component HistoryPage inherits Page {
    VerticalLayout {
        padding: 50px;
        spacing: 15px;
        Text {
            text: "历史活动";
            font-size: Token.font.headline.medium.size;
            font-weight: Token.font.headline.medium.weight;
        }

        ScrollView {
            VerticalLayout {
                spacing: 10px;
                padding: 5px;
                for event in HistoryPageBridge.events: HistoryCard {
                    id: event.id;
                    date-time: event.date-time;
                    title: event.title;
                    description: event.description;
                }
            }
        }

        Rectangle {
            height: 20px;
            SPagination {
                page-size: 10;
                total: 100;
                visible-range: 6;
            }
        }
    }
}
